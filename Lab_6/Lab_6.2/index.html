<!DOCTYPE html>
<html>
<head>
    <title>D3 Interactive Sort</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .bar {
            fill: slategrey;
            transition: all 0.3s;
        }
        .bar:hover {
            fill: orange;
        }
    </style>
</head>
<body>
    <button id="sort">Sort</button>
    <div id="chart"></div>
    
    <script>
        // Initial data
        let dataset = [30, 10, 50, 20, 40];
        const w = 500, h = 300;
        let sortOrder = false; // false = ascending, true = descending
        
        // Create SVG
        const svg = d3.select("#chart")
            .append("svg")
            .attr("width", w)
            .attr("height", h);
            
        // Set up scales
        const xScale = d3.scaleBand()
            .domain(d3.range(dataset.length))
            .range([0, w])
            .paddingInner(0.1);
            
        const yScale = d3.scaleLinear()
            .domain([0, d3.max(dataset)])
            .range([0, h - 20]);
            
        // Draw initial bars
        updateChart();
        
        // Sort button event listener
        d3.select("#sort").on("click", function() {
            sortOrder = !sortOrder;
            sortBars();
        });
        
        function sortBars() {
            // Sort data
            dataset.sort((a, b) => sortOrder ? d3.descending(a, b) : d3.ascending(a, b));
            
            // Update chart with transition
            updateChart();
        }
        
        function updateChart() {
            // Update xScale domain
            xScale.domain(d3.range(dataset.length));
            
            // Select and update bars
            const bars = svg.selectAll(".bar")
                .data(dataset, d => d);
                
            // Remove old bars
            bars.exit().remove();
            
            // Update existing bars
            bars.transition()
                .duration(500)
                .attr("x", (d, i) => xScale(i))
                .attr("y", d => h - yScale(d))
                .attr("width", xScale.bandwidth())
                .attr("height", d => yScale(d));
                
            // Add new bars
            bars.enter()
                .append("rect")
                .attr("class", "bar")
                .attr("x", (d, i) => xScale(i))
                .attr("y", d => h - yScale(d))
                .attr("width", xScale.bandwidth())
                .attr("height", d => yScale(d))
                .append("title")
                .text(d => `Value: ${d}`);
        }
    </script>
</body>
</html>